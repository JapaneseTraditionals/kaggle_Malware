import os
import sys
import importlib
from pathlib import Path
from save_log import stop_watch
ROOT_PATH = Path(__file__).absolute().parents[3]


class FeatureExtractor():
    def __init__(self, features, input_path):
        self.features = features
        self.input_path = input_path

    @stop_watch("FeatureExtractor.extract()")
    def extract(self, is_train):
        """
        Extract features for each group
        Concrete implementations are py/module/features/*.py
        """
        path = os.path.join(os.path.dirname(__file__), '../features')
        sys.path.append(path)
        df_list = []
        for group, feature in self.features.items():
            module = importlib.import_module(group)
            group_feature_class = getattr(module, group)
            df = group_feature_class.extract(feature)
            df_list.append(df)
        print(df_list)
