from module.get_option import *
from module.import_libs import *
from module.process import *
from module.save_log import *
from module.save_outputs import *

# params
VERSION = os.path.basename(__file__)[0:4]

feature_map = {
    "Location": {
        "CountryIdentifier": {
            "simply_use" : None,
            "square": None,
            "div":[
                {"attr": 4},
                {"attr": 5}
            ]
        },
        "CityIdentifier": {
            "simply_use" : None,
            "exp":[
                {"attr1": 4, "attr2": 5},
                {"attr1": 10, "attr2": 14},
            ]
        },
    },
    "Others": {
        "Velocity": {
            "calc":[
                {"attr1": "Meter", "attr2": "time"}
            ]
        },
    }
    # ... many definitions
}


lgbm_params = {
    "device"    : "cpu"
}


def main(args):
    # If you separate csv files, you write like belows:
    validity, predict = process(args, feature_map, lgbm_params)

    # And add validity and predict to the following list:
    validities = [validity]
    predicts = [predict]

    save_outputs(args, validities, predicts)


if __name__=="__main__":
    gc.enable()
    create_logger(VERSION)
    try:
        main(get_option())
    except Exception:
        get_logger(VERSION).exception("Unexpected Exception Occurred.")
