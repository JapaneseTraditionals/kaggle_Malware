from pathlib import Path
from slackclient import SlackClient


class SlackLogger():
    CHANNEL = "log"
    TOKEN_FILE = ".slack_token"
    TOKEN_PATH = Path(__file__).absolute().parents[1] / TOKEN_FILE

    def send_message(text):
        token = SlackLogger._read_text(SlackLogger.TOKEN_PATH)
        client = SlackClient(token)
        client.api_call(
            "chat.postMessage",
            channel=SlackLogger.CHANNEL,
            text=text
        )
        del client

    def _read_text(filename):
        token = ""
        with open(filename, 'r') as f:
            token = f.read()
        token = token.replace('\n', '')
        return token
