from features.base_feature import BaseFeature
from features.base_feature_multi import BaseFeature_multi
import pandas as pd
import dask.dataframe as dd
from exceptions import IrregularExtractArgumentException
from features.get_dtype import get_csv_dtype


class Binary(BaseFeature_multi):

    def get_loadcols(self):
        cols = [
            "IsBeta",
            "IsSxsPassiveMode",
            "HasTpm",
            "IsProtected",
            "AutoSampleOptIn",
            "SMode",
            "Firewall",
            "Census_HasOpticalDiskDrive",
            "Census_IsPortableOperatingSystem",
            "Census_IsFlightingInternal",
            "Census_IsFlightsDisabled",
            "Census_IsSecureBootEnabled",
            "Census_IsWIMBootEnabled",
            "Census_IsVirtualDevice",
            "Census_IsTouchEnabled",
            "Census_IsPenCapable",
            "Census_IsAlwaysOnAlwaysConnectedCapable",
            "Wdft_IsGamer"
        ]
        return cols

    def extract(self):
        return super().extract()

    def plain(self, df):
        return df

    def fillna(self, df, val):
        if isinstance(val, (int, float)):
            df.fillna(val, inplace=True)
        elif val == "mean":
            mean = df.iloc[:, 1].mean()
            df.fillna(mean, inplace=True)
        elif val == "median":
            median = df.iloc[:, 1].median()
            df.fillna(median, inplace=True)
        elif val == "mode":
            mode = df.iloc[:, 1].mode()[0]
            df.fillna(mode, inplace=True)
        else:
            raise IrregularExtractArgumentException
        return df
