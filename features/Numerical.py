from features.base_feature import BaseFeature
import pandas as pd
import dask.dataframe as dd
from exceptions import IrregularExtractArgumentException
from features.get_dtype import get_csv_dtype


class Defender(BaseFeature):

    def extract(self):
        return super().extract()

    def plain(self, df):
        return df

    def fillna(self, df, val):
        if isinstance(val, (int, float)):
            df.fillna(val, inplace=True)
        elif val == "mean":
            mean = df.iloc[:, 1].mean()[0]
            df.fillna(mean, inplace=True)
        elif val == "median":
            median = df.iloc[:, 1].median()[0]
            df.fillna(median, inplace=True)
        elif val == "mode":
            mode = df.iloc[:, 1].mode()[0]
            df.fillna(mode, inplace=True)
        else:
            raise IrregularExtractArgumentException
        return df
