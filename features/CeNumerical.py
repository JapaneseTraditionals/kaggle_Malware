from features.base_feature import BaseFeature
from exceptions import IrregularExtractArgumentException


class CeNumerical(BaseFeature):

    def get_loadcols(self):
        cols = [
            "Census_ProcessorCoreCount",
            "Census_ProcessorModelIdentifier",
            "Census_PrimaryDiskTotalCapacity",
            "Census_SystemVolumeTotalCapacity",
            "Census_TotalPhysicalRAM"
        ]
        return cols

    def extract(self):
        return super().extract()

    def plain(self, df):
        return df

    def processorCoreCount(self, df):
        """
        Census_ProcessorCoreCount
        """
        df["Census_ProcessorCoreCount"] = df["Census_ProcessorCoreCount"].fillna(4).astype(int)
        df.loc[df["Census_ProcessorCoreCount"] > 12, "Census_ProcessorCoreCount"] = 0
        return df[["MachineIdentifier", "Census_ProcessorCoreCount"]]

    def clfProcessorModel(self, df):
        """
        Census_ProcessorModelIdentifier
        """
        df["Census_ProcessorModelIdentifier"] = df["Census_ProcessorModelIdentifier"].fillna(2697).astype(int)
        df["Census_ProcessorModelIdentifier"].where(
            (df["Census_ProcessorModelIdentifier"] < 2000) | (df["Census_ProcessorModelIdentifier"] > 3300),
            2000,
            inplace=True)
        return df[["MachineIdentifier", "Census_ProcessorModelIdentifier"]]

    def clfPrimaryDiskTotalCapacity(self, df):
        """
        Census_PrimaryDiskTotalCapacity
        """
        df["Census_PrimaryDiskTotalCapacity"] = df["Census_PrimaryDiskTotalCapacity"].astype(float).fillna(4.769400e+05)
        df["Census_PrimaryDiskTotalCapacity"].where(df["Census_PrimaryDiskTotalCapacity"] < 400000, 400000, inplace=True)
        return df[["MachineIdentifier", "Census_PrimaryDiskTotalCapacity"]]

    def clfSystemVolumeTotalCapacity(self, df):
        """
        Census_SystemVolumeTotalCapacity
        """
        df["Census_SystemVolumeTotalCapacity"] = df["Census_SystemVolumeTotalCapacity"].fillna(28542).astype(int)
        df["Census_SystemVolumeTotalCapacity"] = (df["Census_SystemVolumeTotalCapacity"] > 10000)
        return df[["MachineIdentifier", "Census_SystemVolumeTotalCapacity"]]

    def clfTotalPhysicalRAM(self, df):
        """
        Census_TotalPhysicalRAM
        """
        df["Census_TotalPhysicalRAM"] = df["Census_TotalPhysicalRAM"].fillna(4096).astype(int)
        df["Census_TotalPhysicalRAM"].where(df["Census_TotalPhysicalRAM"] < 17500, 2500, inplace=True)
        return df[["MachineIdentifier", "Census_TotalPhysicalRAM"]]
