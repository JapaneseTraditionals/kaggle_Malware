from features.base_feature import BaseFeature


class Display(BaseFeature):

    def get_loadcols(self):
        cols = [
            "Census_InternalPrimaryDiagonalDisplaySizeInInches",
            "Census_InternalPrimaryDisplayResolutionHorizontal",
            "Census_InternalPrimaryDisplayResolutionVertical"
        ]
        return cols

    def extract(self):
        return super().extract()

    def ResolutionRatio_fillna_mean(self, df):
        """
        Census_InternalPrimaryDiagonalDisplaySizeInInches
        Census_InternalPrimaryDisplayResolutionHorizontal
        Census_InternalPrimaryDisplayResolutionVertical
        """
        df["ResolutionRatio"] = df["Census_InternalPrimaryDisplayResolutionVertical"] / df["Census_InternalPrimaryDisplayResolutionHorizontal"]
        df["ResolutionRatio"] = df["ResolutionRatio"].astype(float)
        mean = df.loc[:, "ResolutionRatio"].mean()
        df.fillna(mean, inplace=True)
        return df[["MachineIdentifier", "ResolutionRatio"]]

    def ScreenQuality(self, df):
        """
        Census_InternalPrimaryDisplayResolutionVertical
        """
        # Nan
        df = df.assign(ScreenQuality="Nan")
        # SD
        df.loc[df["Census_InternalPrimaryDisplayResolutionVertical"] >= 0, "ScreenQuality"] = "SD"
        # HD
        df.loc[df["Census_InternalPrimaryDisplayResolutionVertical"] >= 720, "ScreenQuality"] = "HD"
        # FullHD
        df.loc[df["Census_InternalPrimaryDisplayResolutionVertical"] >= 1080, "ScreenQuality"] = "FullHD"
        # 4k
        df.loc[df["Census_InternalPrimaryDisplayResolutionVertical"] >= 2160, "ScreenQuality"] = "4k"
        return df[["MachineIdentifier", "ScreenQuality"]]

    def ScreenQuality_is_SD(self, df):
        """
        Census_InternalPrimaryDisplayResolutionVertical
        """
        # SD
        df["ScreenQuality"] = (df["Census_InternalPrimaryDisplayResolutionVertical"] >= 0) & (720 >= df["Census_InternalPrimaryDisplayResolutionVertical"])
        return df[["MachineIdentifier", "ScreenQuality"]]
